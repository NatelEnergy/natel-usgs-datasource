{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///external \"lodash\"","webpack:///./query.ts","webpack:///./module.ts","webpack:///./datasource.ts","webpack:///./query_ctrl.ts","webpack:///external \"app/plugins/sdk\"","webpack:///./css/query-editor.css?1ef8","webpack:///./css/query-editor.css","webpack:///../node_modules/css-loader/lib/css-base.js","webpack:///../node_modules/style-loader/lib/addStyles.js","webpack:///../node_modules/style-loader/lib/urls.js","webpack:///./find_site_modal.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","default","object","property","prototype","hasOwnProperty","p","s","__WEBPACK_EXTERNAL_MODULE__0__","e","USGSQuery","target","this","_lodash2","isEmpty","args","parse","query","forEach","split","idx","indexOf","k","substring","v","length","argsToQueryString","spec","isArray","join","QueryOptionsCtrl","ConfigCtrl","QueryCtrl","Datasource","_query_ctrl","USGSConfigCtrl","templateUrl","USGSQueryOptionsCtrl","_datasource2","USGSDatasourceQueryCtrl","TZ_OFFSETS","GMT","UTC","WET","ACST","ACSST","AEST","AESST","AFT","AKST","AKDT","AST","ADT","AWST","AWSST","BT","CAST","CADT","CCT","CET","CETDST","CST","CDT","DNT","DST","EAST","EASST","EET","EETDST","EST","EDT","FST","FWT","BST","GST","HST","HDT","IDLE","IDLW","IST","IT","JST","JT","KST","LIGT","MET","METDST","MEWT","MEST","MEZ","MST","MDT","MT","NFT","NDT","NOR","NST","NZST","NZDT","NZT","PST","PDT","SAT","SADT","SET","SWT","SST","WAST","WADT","WAT","WETDST","WST","WDT","ZP-11","ZP-2","ZP-3","ZP11","ZP4","ZP5","ZP6","USGSDatasource","instanceSettings","$q","backendSrv","url","id","$inject","options","_this","dataIntervalMS","fmt","isDV","targets","reject","message","q","_query2","has","service","intervalMs","range","from","subtract","utc","format","rangeRaw","to","add","sites","parameterCd","statCd","datasourceRequest","method","then","result","lines","data","info","readRDB","show","res","series","push","asGrafanaSeries","rdb","line","startsWith","trim","agency","site","lastIndexOf","siteID","headers","match","idToField","vals","j","Description","datapoints","values","TS_ID","Parameter","Statistic","alias","parts","index","dates","hasTZ","date","tz","off","_moment2","valueOf","val","parseFloat","testDatasource","console","log","rsp","status","title","catch","ex","msg","annotationQuery","Error","metricFindQuery","u","a","setPrototypeOf","__proto__","Array","constructor","_super","$scope","$rootScope","$injector","uiSegmentSrv","refresh","isNil","validateArgsAndCheckInfo","__extends","doSitePopup","scope","$new","datasource","appEvent","templateHtml","toggleSeries","isSelected","unset","onChangeInternal","hasIn","toggleEditorMode","rawQuery","onChangeQuery","doRefresh","size","ids","includes","clean","panelCtrl","content","hmr","transform","insertInto","locals","version","sources","names","mappings","file","sourcesContent","sourceRoot","list","toString","map","item","useSourceMap","cssMapping","btoa","sourceMapping","sourceMap","sourceURLs","source","mediaQuery","alreadyImportedModules","stylesInDom","isOldIE","memo","window","document","all","atob","apply","arguments","styleTarget","HTMLIFrameElement","contentDocument","head","singleton","stylesInsertedAtTop","fixUrls","addStylesToDom","styles","domStyle","refs","addStyle","listToStyles","newStyles","base","part","css","media","getElement","lastStyleElementInsertedAtTop","insertAt","nextSibling","insertBefore","style","appendChild","firstChild","before","removeStyleElement","parentNode","removeChild","splice","h","createElement","attrs","type","insertStyleElement","addAttrs","el","keys","setAttribute","update","remove","obj","styleIndex","singletonCounter","createStyleElement","applyToSingletonTag","URL","createObjectURL","revokeObjectURL","Blob","link","rel","g","autoFixUrls","convertToAbsoluteUrls","blob","oldSrc","href","styleSheet","cssText","createTextNode","newObj","DEBUG","mayRemove","newList","textStore","replacement","filter","Boolean","replaceText","childNodes","cssNode","location","currentDir","baseUrl","pathname","replace","fullMatch","origUrl","newUrl","unquotedOrigUrl","$1","test","findUSGSSiteModalDirective","FindUSGSSiteModal","onSave","dismiss","$parent","restrict","controller","bindToController","transclude","controllerAs"],"mappings":"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","file":"module.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2);\n","module.exports = __WEBPACK_EXTERNAL_MODULE__0__;","///<reference path=\"../node_modules/grafana-sdk-mocks/app/headers/common.d.ts\" />\r\n\r\nimport _ from \"lodash\";\r\n\r\n\r\nexport default class USGSQuery {\r\n\r\n  constructor(public target) {\r\n    if(target && _.isEmpty(target.args)) {\r\n      target.args = this.parse(target.query);\r\n    }\r\n  }\r\n\r\n  parse(query) {\r\n    var args = {};\r\n    if(query) {\r\n      _.forEach( query.split('&'), s => {\r\n        let idx = s.indexOf('=');\r\n        let k = s.substring(0,idx);\r\n        let v = s.substring(idx+1);\r\n\r\n        if(k.length>0 && v.length>0) {\r\n          if (k === 'parameterCd' || k === 'statCd' || k === 'tsid' || k === 'sites' || k == 'keys' ) {\r\n            v = v.split(',');\r\n          }\r\n\r\n          args[k] = v;\r\n        } \r\n      });\r\n    }\r\n    return args;\r\n  }\r\n\r\n  argsToQueryString(args) {\r\n    var spec = \"\";\r\n    _.forEach( args, (v,k) => {\r\n      if(v != null && v.length>0) {\r\n        spec += '&' + k + '=';\r\n        if(_.isArray(v)) {\r\n          spec += v.join();\r\n        }\r\n        else {\r\n          spec += v;\r\n        }\r\n      }\r\n    });\r\n    return spec;\r\n  }\r\n}\r\n","import  USGSDatasource from './datasource';\r\nimport {USGSDatasourceQueryCtrl} from './query_ctrl';\r\n\r\n// Exports the modal window\r\nimport './find_site_modal';\r\n\r\nclass USGSConfigCtrl {\r\n  static templateUrl = 'partials/config.html';\r\n}\r\n\r\nclass USGSQueryOptionsCtrl {\r\n  static templateUrl = 'partials/query.options.html';\r\n}\r\n\r\nexport {\r\n  USGSDatasource as Datasource,\r\n  USGSDatasourceQueryCtrl as QueryCtrl,\r\n  USGSConfigCtrl as ConfigCtrl,\r\n  USGSQueryOptionsCtrl as QueryOptionsCtrl\r\n};\r\n","///<reference path=\"../node_modules/grafana-sdk-mocks/app/headers/common.d.ts\" />\r\n\r\nimport _ from 'lodash';\r\nimport moment from 'moment';\r\nimport USGSQuery from './query';\r\n\r\n// From: https://help.waterdata.usgs.gov/tz\r\nconst _MSPH = 60*60*1000;\r\nconst TZ_OFFSETS = { \r\n  'GMT':      0,\r\n  'UTC':      0,\r\n  'WET':      0,\r\n\r\n  'ACST':   9.5 * _MSPH,\r\n  'ACSST': 10.5 * _MSPH,\r\n  'AEST':    10 * _MSPH,\r\n  'AESST':   11 * _MSPH,\r\n  'AFT':    4.5 * _MSPH,\r\n  'AKST':    -9 * _MSPH,\r\n  'AKDT':    -8 * _MSPH,\r\n  'AST':     -4 * _MSPH,\r\n  'ADT':     -3 * _MSPH,\r\n  'AWST':     8 * _MSPH,\r\n  'AWSST':    9 * _MSPH,\r\n  'BT':       3 * _MSPH,\r\n  'CAST':   9.5 * _MSPH,\r\n  'CADT':  10.5 * _MSPH,\r\n  'CCT':      8 * _MSPH,\r\n  'CET':      1 * _MSPH,\r\n  'CETDST':   2 * _MSPH,\r\n  'CST':     -6 * _MSPH,\r\n  'CDT':     -5 * _MSPH,\r\n  'DNT':      1 * _MSPH,\r\n  'DST':      1 * _MSPH,\r\n  'EAST':    10 * _MSPH,\r\n  'EASST':   11 * _MSPH,\r\n  'EET':      2 * _MSPH,\r\n  'EETDST':   3 * _MSPH,\r\n  'EST':     -5 * _MSPH,\r\n  'EDT':     -4 * _MSPH,\r\n  'FST':      1 * _MSPH,\r\n  'FWT':      2 * _MSPH,\r\n  'BST':      1 * _MSPH,\r\n  'GST':     10 * _MSPH,\r\n  'HST':    -10 * _MSPH,\r\n  'HDT':     -9 * _MSPH,\r\n  'IDLE':    12 * _MSPH,\r\n  'IDLW':   -12 * _MSPH,\r\n  'IST':      2 * _MSPH,\r\n  'IT':     3.5 * _MSPH,\r\n  'JST':      9 * _MSPH,\r\n  'JT':     7.5 * _MSPH,\r\n  'KST':      9 * _MSPH,\r\n  'LIGT':    10 * _MSPH,\r\n  'MET':      1 * _MSPH,\r\n  'METDST':   2 * _MSPH,\r\n  'MEWT':     1 * _MSPH,\r\n  'MEST':     2 * _MSPH,\r\n  'MEZ':      1 * _MSPH,\r\n  'MST':     -7 * _MSPH,\r\n  'MDT':     -6 * _MSPH,\r\n  'MT':     8.5 * _MSPH,\r\n  'NFT':   -3.5 * _MSPH,\r\n  'NDT':   -2.5 * _MSPH,\r\n  'NOR':      1 * _MSPH,\r\n  'NST':   -3.5 * _MSPH,\r\n  'NZST':    12 * _MSPH,\r\n  'NZDT':    13 * _MSPH,\r\n  'NZT':     12 * _MSPH,\r\n  'PST':     -8 * _MSPH,\r\n  'PDT':     -7 * _MSPH,\r\n  'SAT':    9.5 * _MSPH,\r\n  'SADT':  10.5 * _MSPH,\r\n  'SET':      1 * _MSPH,\r\n  'SWT':      1 * _MSPH,\r\n  'SST':      2 * _MSPH,\r\n  'WAST':     7 * _MSPH,\r\n  'WADT':     8 * _MSPH,\r\n  'WAT':     -1 * _MSPH,\r\n  'WETDST':   1 * _MSPH,\r\n  'WST':      8 * _MSPH,\r\n  'WDT':      9 * _MSPH,\r\n  'ZP-11':  -11 * _MSPH,\r\n  'ZP-2':    -2 * _MSPH,\r\n  'ZP-3':    -3 * _MSPH,\r\n  'ZP11':    11 * _MSPH,\r\n  'ZP4':      4 * _MSPH,\r\n  'ZP5':      5 * _MSPH,\r\n  'ZP6':      6 * _MSPH\r\n };\r\n\r\n\r\n\r\nexport default class USGSDatasource {\r\n  id: number;\r\n  name: string;\r\n\r\n  public url: string =  'https://waterservices.usgs.gov/nwis/';\r\n\r\n  /** @ngInject */\r\n  constructor(instanceSettings, private $q, private backendSrv) {\r\n    this.id = instanceSettings.id;\r\n    this.name = instanceSettings.name;\r\n  }\r\n  \r\n  query(options) {\r\n    // console.log( \"QUERY\", options );\r\n    let dataIntervalMS = 15*60*1000  * 2;\r\n    let fmt = 'YYYY-MM-DDTHH:mm:00[Z]'; // UTC without seconds\r\n    var isDV = false;\r\n\r\n    if(options.targets.length > 1) {\r\n      return this.$q.reject( { message: 'USGS does not (yet) support multiple targets'} );\r\n    }\r\n    var target = options.targets[0];\r\n    var args = target.args;\r\n    if(!args) {\r\n      const q = new USGSQuery(target);\r\n      args = q.target.args;\r\n    }\r\n    if(!args || !_.has(args, 'sites')) {\r\n      return this.$q.reject( { message: 'Missing USGS Site Selection' });\r\n    }\r\n\r\n    if(!_.has(args, 'service')) {\r\n      args.service = 'iv';\r\n    }\r\n\r\n    var url = this.url;\r\n    if(target.args.service === 'dv' || options.intervalMs > 3000000) {\r\n      url += 'dv/service/?format=rdb';\r\n      dataIntervalMS = 24*60*60*1000;\r\n      fmt = 'YYYY-MM-DD';\r\n      isDV = true;\r\n    }\r\n    else {\r\n      url += 'iv/service/?format=rdb';\r\n    }\r\n\r\n    let from = options.range.from.subtract( dataIntervalMS, 'ms' );\r\n    url += '&startDT=' +  from.utc().format(fmt);\r\n    if( \"now\" != options.rangeRaw.to ) {\r\n      let to = options.range.to.add( dataIntervalMS + (6000), 'ms' );\r\n      url += '&endDT=' +  to.utc().format(fmt);\r\n    }\r\n\r\n    url += '&sites=' + target.args.sites;\r\n\r\n    if(target.args.parameterCd) {\r\n      url += '&parameterCd=' + target.args.parameterCd.join();\r\n    }\r\n\r\n    if(target.args.statCd && isDV) {\r\n      url += '&statCd=' + target.args.statCd.join();\r\n    }\r\n\r\n    return this.backendSrv.datasourceRequest({\r\n      url: url,\r\n      method: 'GET'\r\n    }).then( result => {\r\n      var lines = result.data.split('\\n');\r\n      var info = this.readRDB(lines, true, args.show );\r\n\r\n     // console.log( \"TO Timeseries\", info );\r\n\r\n      var res:any = { data: [] };\r\n      _.forEach(info.series, series => {\r\n        res.data.push( series );\r\n      });\r\n      return res;\r\n    });\r\n  }\r\n\r\n\r\n  readRDB( lines, asGrafanaSeries, show ) {\r\n    var rdb: any = {};\r\n    rdb.series = [];\r\n\r\n    let idx = 0;\r\n    var i = 1;\r\n    var line = lines[i];\r\n    while( i<lines.length && !line.startsWith('# Data for')) {\r\n      line = lines[++i];\r\n    }\r\n    if(i>= lines.length) {\r\n      return; // did not find anything\r\n    }\r\n\r\n    line = lines[++i];\r\n    if(line != null) {\r\n      line = line.substring(2).trim();\r\n      \r\n      idx = line.indexOf(' ');\r\n      rdb.agency = line.substring(0,idx);\r\n\r\n      idx = line.indexOf(' ', idx+1);\r\n      rdb.site = line.substring(idx+1);\r\n    }\r\n    // console.log( 'READ', rdb.site, asGrafanaSeries );\r\n\r\n    while( i<lines.length && !line.startsWith('# Data provided')) {\r\n      line = lines[++i];\r\n    }\r\n\r\n    idx = line.lastIndexOf(' ');\r\n    rdb.siteID = line.substring(idx+1).trim();\r\n\r\n    line = lines[++i];\r\n\r\n    idx = line.indexOf('Description');\r\n    let headers = line.substring(2,idx).match(/[^ ]+/g);\r\n\r\n    line = lines[++i];\r\n    var idToField = {};\r\n    while( i<lines.length && line.startsWith('#  ')) {\r\n      var vals = line.substring(2,idx).match(/[^ ]+/g);\r\n      var s: any = {};\r\n      for(var j=0; j<headers.length; j++) {\r\n        s[headers[j]] = vals[j];\r\n      }\r\n      s.Description = line.substring(idx).trim();\r\n      if(asGrafanaSeries) {\r\n        s.datapoints = [];\r\n      }\r\n      else {\r\n        s.values = [];\r\n      }\r\n\r\n      s.key = s.TS_ID + '_' + s.Parameter;\r\n      if(_.has(s, 'Statistic')) {\r\n        s.key += '_' + s.Statistic;\r\n      }\r\n\r\n      // Set the display value\r\n      let alias = '';\r\n      if(show == null || _.has(show, s.key)) {\r\n        if(show != null) {\r\n          alias = show[s.key];\r\n        }\r\n        if(!alias || alias.length==0) {\r\n          s.target = s.Description;\r\n        }\r\n        else {\r\n          s.target = alias;\r\n        }\r\n        idToField[s.key] = s;\r\n        rdb.series.push( s );\r\n      }\r\n\r\n      line = lines[++i];\r\n    }\r\n\r\n    // Read to the end of the header\r\n    while( i<lines.length && line.startsWith('#')) {\r\n      line = lines[++i];\r\n    }\r\n\r\n    var parts = line.split('\\t');\r\n    for(var j=0; j<parts.length; j++) {\r\n      if(_.has(idToField, parts[j])) {\r\n        idToField[parts[j]].index = j;\r\n      }\r\n    }\r\n    rdb.dates = [];\r\n    var hasTZ = 'tz_cd' === parts[3];\r\n\r\n    i++; i++; // skip the line about size\r\n    while( i<lines.length) {\r\n      line = lines[i++];\r\n      if(line.length > 5) {\r\n        parts = line.split('\\t')\r\n\r\n        // agency = parts[0];\r\n        // site = parts[0];\r\n        let date = parts[2];\r\n        var d = 0;\r\n        if(hasTZ) {\r\n          let tz = parts[3];\r\n          let off = TZ_OFFSETS[tz];\r\n          d = moment.utc( date ).valueOf() - off;\r\n        }\r\n        else {\r\n          d = moment( date ).valueOf(); // local time/  TODO, should be in the TZ of the site\r\n        }\r\n        rdb.dates.push( d );\r\n\r\n        for(var j=0; j<rdb.series.length; j++) {\r\n          var s = rdb.series[j];\r\n          var val = parts[s.index];\r\n          if(val && val.length > 0) {\r\n            val = parseFloat(val);\r\n          }\r\n          else {\r\n            val = null;\r\n          }\r\n          if(asGrafanaSeries) {\r\n            s.datapoints.push( [val, d] );\r\n          }\r\n          else {\r\n            s.values.push(val);\r\n          }\r\n        }\r\n      }\r\n    }\r\n    return rdb;\r\n  }\r\n\r\n  testDatasource() {\r\n    let options = {\r\n      range: {\r\n        from: moment().add(-4, 'h')\r\n      },\r\n      rangeRaw: {\r\n        to: 'now'\r\n      },\r\n      targets: [{\r\n        query: \"&sites=01646500&service=iv&parameterCd=00010\"\r\n      }]\r\n    };\r\n\r\n    console.log( 'USGS TEST', this );\r\n    return this.query(options).then( rsp => {\r\n      return { status: \"success\", message: \"Data source is working\", title: \"Success\" };\r\n    }).catch( ex => {\r\n      console.log( \"Error Testing USGS\", ex);\r\n      let msg = ex;\r\n      if(ex.message) {\r\n        msg = ex.message;\r\n      }\r\n      return { status: \"error\", message: msg };\r\n    });\r\n  }\r\n\r\n  annotationQuery(options) {\r\n    throw new Error(\"Annotation Support not implemented yet.\");\r\n  }\r\n\r\n  metricFindQuery(query: string) {\r\n    throw new Error(\"Template Variable Support not implemented yet. (metricFindQuery)\");\r\n  }\r\n}\r\n","///<reference path=\"../node_modules/grafana-sdk-mocks/app/headers/common.d.ts\" />\r\n\r\nimport _ from 'lodash';\r\nimport {QueryCtrl} from 'app/plugins/sdk';\r\nimport './css/query-editor.css'\r\n\r\nimport USGSQuery from './query';\r\n\r\nexport class USGSDatasourceQueryCtrl extends QueryCtrl {\r\n  static templateUrl = 'partials/query.editor.html';\r\n\r\n  query: USGSQuery;\r\n  key: string;\r\n  info: any;\r\n\r\n  /** @ngInject */\r\n  constructor(private $scope, private $rootScope, public $injector, public uiSegmentSrv)  {\r\n    super($scope, $injector);\r\n\r\n    let refresh = false;\r\n    if(_.isNil(this.target.query)) {\r\n      this.target.query = '&sites=01646500&service=iv';\r\n      refresh = true;\r\n    }\r\n    this.query = new USGSQuery(this.target);\r\n    this.validateArgsAndCheckInfo();\r\n    if(refresh) {\r\n      this.panelCtrl.refresh();\r\n    }\r\n  }\r\n\r\n  doSitePopup() {\r\n    var scope = this.$scope.$new(true);\r\n    scope.target = this.target;\r\n    scope.datasource = this.datasource;\r\n    this.$rootScope.appEvent('show-modal', {\r\n       templateHtml: '<find-usgs-site-modal target=\"target\" datasource=\"datasource\"></find-usgs-site-modal>',\r\n       scope\r\n    });\r\n  }\r\n\r\n  toggleSeries(series) {\r\n    var show = this.target.args.show;\r\n    if(this.isSelected(series)) {\r\n      _.unset( show, series.key );\r\n    }\r\n    else {\r\n      if(!show) {\r\n         this.target.args.show = show = {};\r\n      }\r\n      show[series.key] = '';\r\n    }\r\n    this.onChangeInternal();\r\n  }\r\n\r\n  isSelected(series) {\r\n    return( _.hasIn( this.target.args, 'show.'+series.key ) );\r\n  }\r\n\r\n  toggleEditorMode() {\r\n    this.target.rawQuery = !this.target.rawQuery;\r\n  }\r\n\r\n  onChangeQuery() {\r\n    this.target.args = this.query.parse(this.target.query);\r\n    this.validateArgsAndCheckInfo(true);\r\n  }\r\n\r\n  onChangeInternal() {\r\n    this.validateArgsAndCheckInfo(true);\r\n  }\r\n\r\n  validateArgsAndCheckInfo(doRefresh: boolean=false) {\r\n    // Pick the params and Stats from the keys\r\n    var args = this.target.args;\r\n\r\n    // Just in case\r\n    _.unset( args, 'parameterCd'); \r\n    _.unset( args, 'statCd'); \r\n\r\n    // Get the parameter and stats code from the \r\n    if(args.show) {\r\n      if(_.size(args.show) > 0) {\r\n        _.forEach(args.show, (v,k) => {\r\n          var ids = k.split('_');\r\n          if(ids.length>1) {\r\n            var val = ids[1];\r\n            if(args.parameterCd==null) {\r\n              args.parameterCd = [val];\r\n            }\r\n            else if(!_.includes(args.parameterCd, val)) {\r\n              args.parameterCd.push(val);\r\n            }\r\n          }\r\n          if(ids.length>2) {\r\n            var val = ids[2];\r\n            if(args.statCd==null) {\r\n              args.statCd = [val];\r\n            }\r\n            else if(!_.includes(args.statCd, val)) {\r\n              args.statCd.push(val);\r\n            }\r\n          }\r\n        });\r\n      }\r\n      else {\r\n        _.unset( args, 'show'); \r\n      }\r\n    }\r\n\r\n    var key = args.service + '@' + args.sites;\r\n    if(this.key != key) {\r\n      this.key = key;\r\n      var url = 'https://waterservices.usgs.gov/nwis/'+args.service+'/service/?format=rdb&sites=' + args.sites;\r\n      return this.datasource.backendSrv.datasourceRequest({\r\n        url: url,\r\n        method: 'GET'\r\n      }).then( result => {\r\n        var lines = result.data.split('\\n');\r\n        this.info = this.datasource.readRDB(lines, false, null );\r\n\r\n        // Make sure the values exist\r\n        if(args.show) {\r\n          var clean = {};\r\n          _.forEach(args.show, (v,k) => {\r\n            _.forEach(this.info.series, (s) => {\r\n              if(k === s.key) {\r\n                clean[k] = v;\r\n                return false;\r\n              }\r\n              return true;\r\n            });\r\n          });\r\n\r\n          if(_.size(clean)>0) {\r\n            args.show = clean;\r\n          }\r\n          else {\r\n            _.unset( args, 'show'); \r\n          }\r\n        }\r\n\r\n        if(doRefresh) {\r\n          this.target.query = this.query.argsToQueryString(args);\r\n          this.panelCtrl.refresh(); \r\n        }\r\n      });\r\n    }\r\n    else if(doRefresh) {\r\n      this.target.query = this.query.argsToQueryString(args);\r\n      this.panelCtrl.refresh(); // Asks the panel to refresh data.\r\n    }\r\n  }\r\n}","module.exports = __WEBPACK_EXTERNAL_MODULE__6__;","\nvar content = require(\"!!../../node_modules/css-loader/index.js??ref--5-1!./query-editor.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../node_modules/css-loader/index.js??ref--5-1!./query-editor.css\", function() {\n\t\tvar newContent = require(\"!!../../node_modules/css-loader/index.js??ref--5-1!./query-editor.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \".generic-datasource-query-row .query-keyword {\\r\\n  width: 75px;\\r\\n}\", \"\", {\"version\":3,\"sources\":[\"C:/workspace/grafana-plugins/natel-usgs-datasource/src/css/query-editor.css\"],\"names\":[],\"mappings\":\"AAAA;EACE,YAAY;CACb\",\"file\":\"query-editor.css\",\"sourcesContent\":[\".generic-datasource-query-row .query-keyword {\\r\\n  width: 75px;\\r\\n}\"],\"sourceRoot\":\"\"}]);\n\n// exports\n","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\nmodule.exports = function(useSourceMap) {\n\tvar list = [];\n\n\t// return the list of modules as css string\n\tlist.toString = function toString() {\n\t\treturn this.map(function (item) {\n\t\t\tvar content = cssWithMappingToString(item, useSourceMap);\n\t\t\tif(item[2]) {\n\t\t\t\treturn \"@media \" + item[2] + \"{\" + content + \"}\";\n\t\t\t} else {\n\t\t\t\treturn content;\n\t\t\t}\n\t\t}).join(\"\");\n\t};\n\n\t// import a list of modules into the list\n\tlist.i = function(modules, mediaQuery) {\n\t\tif(typeof modules === \"string\")\n\t\t\tmodules = [[null, modules, \"\"]];\n\t\tvar alreadyImportedModules = {};\n\t\tfor(var i = 0; i < this.length; i++) {\n\t\t\tvar id = this[i][0];\n\t\t\tif(typeof id === \"number\")\n\t\t\t\talreadyImportedModules[id] = true;\n\t\t}\n\t\tfor(i = 0; i < modules.length; i++) {\n\t\t\tvar item = modules[i];\n\t\t\t// skip already imported module\n\t\t\t// this implementation is not 100% perfect for weird media query combinations\n\t\t\t//  when a module is imported multiple times with different media queries.\n\t\t\t//  I hope this will never occur (Hey this way we have smaller bundles)\n\t\t\tif(typeof item[0] !== \"number\" || !alreadyImportedModules[item[0]]) {\n\t\t\t\tif(mediaQuery && !item[2]) {\n\t\t\t\t\titem[2] = mediaQuery;\n\t\t\t\t} else if(mediaQuery) {\n\t\t\t\t\titem[2] = \"(\" + item[2] + \") and (\" + mediaQuery + \")\";\n\t\t\t\t}\n\t\t\t\tlist.push(item);\n\t\t\t}\n\t\t}\n\t};\n\treturn list;\n};\n\nfunction cssWithMappingToString(item, useSourceMap) {\n\tvar content = item[1] || '';\n\tvar cssMapping = item[3];\n\tif (!cssMapping) {\n\t\treturn content;\n\t}\n\n\tif (useSourceMap && typeof btoa === 'function') {\n\t\tvar sourceMapping = toComment(cssMapping);\n\t\tvar sourceURLs = cssMapping.sources.map(function (source) {\n\t\t\treturn '/*# sourceURL=' + cssMapping.sourceRoot + source + ' */'\n\t\t});\n\n\t\treturn [content].concat(sourceURLs).concat([sourceMapping]).join('\\n');\n\t}\n\n\treturn [content].join('\\n');\n}\n\n// Adapted from convert-source-map (MIT)\nfunction toComment(sourceMap) {\n\t// eslint-disable-next-line no-undef\n\tvar base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));\n\tvar data = 'sourceMappingURL=data:application/json;charset=utf-8;base64,' + base64;\n\n\treturn '/*# ' + data + ' */';\n}\n","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\nvar stylesInDom = {};\n\nvar\tmemoize = function (fn) {\n\tvar memo;\n\n\treturn function () {\n\t\tif (typeof memo === \"undefined\") memo = fn.apply(this, arguments);\n\t\treturn memo;\n\t};\n};\n\nvar isOldIE = memoize(function () {\n\t// Test for IE <= 9 as proposed by Browserhacks\n\t// @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n\t// Tests for existence of standard globals is to allow style-loader\n\t// to operate correctly into non-standard environments\n\t// @see https://github.com/webpack-contrib/style-loader/issues/177\n\treturn window && document && document.all && !window.atob;\n});\n\nvar getTarget = function (target) {\n  return document.querySelector(target);\n};\n\nvar getElement = (function (fn) {\n\tvar memo = {};\n\n\treturn function(target) {\n                // If passing function in options, then use it for resolve \"head\" element.\n                // Useful for Shadow Root style i.e\n                // {\n                //   insertInto: function () { return document.querySelector(\"#foo\").shadowRoot }\n                // }\n                if (typeof target === 'function') {\n                        return target();\n                }\n                if (typeof memo[target] === \"undefined\") {\n\t\t\tvar styleTarget = getTarget.call(this, target);\n\t\t\t// Special case to return head of iframe instead of iframe itself\n\t\t\tif (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n\t\t\t\ttry {\n\t\t\t\t\t// This will throw an exception if access to iframe is blocked\n\t\t\t\t\t// due to cross-origin restrictions\n\t\t\t\t\tstyleTarget = styleTarget.contentDocument.head;\n\t\t\t\t} catch(e) {\n\t\t\t\t\tstyleTarget = null;\n\t\t\t\t}\n\t\t\t}\n\t\t\tmemo[target] = styleTarget;\n\t\t}\n\t\treturn memo[target]\n\t};\n})();\n\nvar singleton = null;\nvar\tsingletonCounter = 0;\nvar\tstylesInsertedAtTop = [];\n\nvar\tfixUrls = require(\"./urls\");\n\nmodule.exports = function(list, options) {\n\tif (typeof DEBUG !== \"undefined\" && DEBUG) {\n\t\tif (typeof document !== \"object\") throw new Error(\"The style-loader cannot be used in a non-browser environment\");\n\t}\n\n\toptions = options || {};\n\n\toptions.attrs = typeof options.attrs === \"object\" ? options.attrs : {};\n\n\t// Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n\t// tags it will allow on a page\n\tif (!options.singleton && typeof options.singleton !== \"boolean\") options.singleton = isOldIE();\n\n\t// By default, add <style> tags to the <head> element\n        if (!options.insertInto) options.insertInto = \"head\";\n\n\t// By default, add <style> tags to the bottom of the target\n\tif (!options.insertAt) options.insertAt = \"bottom\";\n\n\tvar styles = listToStyles(list, options);\n\n\taddStylesToDom(styles, options);\n\n\treturn function update (newList) {\n\t\tvar mayRemove = [];\n\n\t\tfor (var i = 0; i < styles.length; i++) {\n\t\t\tvar item = styles[i];\n\t\t\tvar domStyle = stylesInDom[item.id];\n\n\t\t\tdomStyle.refs--;\n\t\t\tmayRemove.push(domStyle);\n\t\t}\n\n\t\tif(newList) {\n\t\t\tvar newStyles = listToStyles(newList, options);\n\t\t\taddStylesToDom(newStyles, options);\n\t\t}\n\n\t\tfor (var i = 0; i < mayRemove.length; i++) {\n\t\t\tvar domStyle = mayRemove[i];\n\n\t\t\tif(domStyle.refs === 0) {\n\t\t\t\tfor (var j = 0; j < domStyle.parts.length; j++) domStyle.parts[j]();\n\n\t\t\t\tdelete stylesInDom[domStyle.id];\n\t\t\t}\n\t\t}\n\t};\n};\n\nfunction addStylesToDom (styles, options) {\n\tfor (var i = 0; i < styles.length; i++) {\n\t\tvar item = styles[i];\n\t\tvar domStyle = stylesInDom[item.id];\n\n\t\tif(domStyle) {\n\t\t\tdomStyle.refs++;\n\n\t\t\tfor(var j = 0; j < domStyle.parts.length; j++) {\n\t\t\t\tdomStyle.parts[j](item.parts[j]);\n\t\t\t}\n\n\t\t\tfor(; j < item.parts.length; j++) {\n\t\t\t\tdomStyle.parts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\t\t} else {\n\t\t\tvar parts = [];\n\n\t\t\tfor(var j = 0; j < item.parts.length; j++) {\n\t\t\t\tparts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\n\t\t\tstylesInDom[item.id] = {id: item.id, refs: 1, parts: parts};\n\t\t}\n\t}\n}\n\nfunction listToStyles (list, options) {\n\tvar styles = [];\n\tvar newStyles = {};\n\n\tfor (var i = 0; i < list.length; i++) {\n\t\tvar item = list[i];\n\t\tvar id = options.base ? item[0] + options.base : item[0];\n\t\tvar css = item[1];\n\t\tvar media = item[2];\n\t\tvar sourceMap = item[3];\n\t\tvar part = {css: css, media: media, sourceMap: sourceMap};\n\n\t\tif(!newStyles[id]) styles.push(newStyles[id] = {id: id, parts: [part]});\n\t\telse newStyles[id].parts.push(part);\n\t}\n\n\treturn styles;\n}\n\nfunction insertStyleElement (options, style) {\n\tvar target = getElement(options.insertInto)\n\n\tif (!target) {\n\t\tthrow new Error(\"Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.\");\n\t}\n\n\tvar lastStyleElementInsertedAtTop = stylesInsertedAtTop[stylesInsertedAtTop.length - 1];\n\n\tif (options.insertAt === \"top\") {\n\t\tif (!lastStyleElementInsertedAtTop) {\n\t\t\ttarget.insertBefore(style, target.firstChild);\n\t\t} else if (lastStyleElementInsertedAtTop.nextSibling) {\n\t\t\ttarget.insertBefore(style, lastStyleElementInsertedAtTop.nextSibling);\n\t\t} else {\n\t\t\ttarget.appendChild(style);\n\t\t}\n\t\tstylesInsertedAtTop.push(style);\n\t} else if (options.insertAt === \"bottom\") {\n\t\ttarget.appendChild(style);\n\t} else if (typeof options.insertAt === \"object\" && options.insertAt.before) {\n\t\tvar nextSibling = getElement(options.insertInto + \" \" + options.insertAt.before);\n\t\ttarget.insertBefore(style, nextSibling);\n\t} else {\n\t\tthrow new Error(\"[Style Loader]\\n\\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\\n Must be 'top', 'bottom', or Object.\\n (https://github.com/webpack-contrib/style-loader#insertat)\\n\");\n\t}\n}\n\nfunction removeStyleElement (style) {\n\tif (style.parentNode === null) return false;\n\tstyle.parentNode.removeChild(style);\n\n\tvar idx = stylesInsertedAtTop.indexOf(style);\n\tif(idx >= 0) {\n\t\tstylesInsertedAtTop.splice(idx, 1);\n\t}\n}\n\nfunction createStyleElement (options) {\n\tvar style = document.createElement(\"style\");\n\n\tif(options.attrs.type === undefined) {\n\t\toptions.attrs.type = \"text/css\";\n\t}\n\n\taddAttrs(style, options.attrs);\n\tinsertStyleElement(options, style);\n\n\treturn style;\n}\n\nfunction createLinkElement (options) {\n\tvar link = document.createElement(\"link\");\n\n\tif(options.attrs.type === undefined) {\n\t\toptions.attrs.type = \"text/css\";\n\t}\n\toptions.attrs.rel = \"stylesheet\";\n\n\taddAttrs(link, options.attrs);\n\tinsertStyleElement(options, link);\n\n\treturn link;\n}\n\nfunction addAttrs (el, attrs) {\n\tObject.keys(attrs).forEach(function (key) {\n\t\tel.setAttribute(key, attrs[key]);\n\t});\n}\n\nfunction addStyle (obj, options) {\n\tvar style, update, remove, result;\n\n\t// If a transform function was defined, run it on the css\n\tif (options.transform && obj.css) {\n\t    result = options.transform(obj.css);\n\n\t    if (result) {\n\t    \t// If transform returns a value, use that instead of the original css.\n\t    \t// This allows running runtime transformations on the css.\n\t    \tobj.css = result;\n\t    } else {\n\t    \t// If the transform function returns a falsy value, don't add this css.\n\t    \t// This allows conditional loading of css\n\t    \treturn function() {\n\t    \t\t// noop\n\t    \t};\n\t    }\n\t}\n\n\tif (options.singleton) {\n\t\tvar styleIndex = singletonCounter++;\n\n\t\tstyle = singleton || (singleton = createStyleElement(options));\n\n\t\tupdate = applyToSingletonTag.bind(null, style, styleIndex, false);\n\t\tremove = applyToSingletonTag.bind(null, style, styleIndex, true);\n\n\t} else if (\n\t\tobj.sourceMap &&\n\t\ttypeof URL === \"function\" &&\n\t\ttypeof URL.createObjectURL === \"function\" &&\n\t\ttypeof URL.revokeObjectURL === \"function\" &&\n\t\ttypeof Blob === \"function\" &&\n\t\ttypeof btoa === \"function\"\n\t) {\n\t\tstyle = createLinkElement(options);\n\t\tupdate = updateLink.bind(null, style, options);\n\t\tremove = function () {\n\t\t\tremoveStyleElement(style);\n\n\t\t\tif(style.href) URL.revokeObjectURL(style.href);\n\t\t};\n\t} else {\n\t\tstyle = createStyleElement(options);\n\t\tupdate = applyToTag.bind(null, style);\n\t\tremove = function () {\n\t\t\tremoveStyleElement(style);\n\t\t};\n\t}\n\n\tupdate(obj);\n\n\treturn function updateStyle (newObj) {\n\t\tif (newObj) {\n\t\t\tif (\n\t\t\t\tnewObj.css === obj.css &&\n\t\t\t\tnewObj.media === obj.media &&\n\t\t\t\tnewObj.sourceMap === obj.sourceMap\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tupdate(obj = newObj);\n\t\t} else {\n\t\t\tremove();\n\t\t}\n\t};\n}\n\nvar replaceText = (function () {\n\tvar textStore = [];\n\n\treturn function (index, replacement) {\n\t\ttextStore[index] = replacement;\n\n\t\treturn textStore.filter(Boolean).join('\\n');\n\t};\n})();\n\nfunction applyToSingletonTag (style, index, remove, obj) {\n\tvar css = remove ? \"\" : obj.css;\n\n\tif (style.styleSheet) {\n\t\tstyle.styleSheet.cssText = replaceText(index, css);\n\t} else {\n\t\tvar cssNode = document.createTextNode(css);\n\t\tvar childNodes = style.childNodes;\n\n\t\tif (childNodes[index]) style.removeChild(childNodes[index]);\n\n\t\tif (childNodes.length) {\n\t\t\tstyle.insertBefore(cssNode, childNodes[index]);\n\t\t} else {\n\t\t\tstyle.appendChild(cssNode);\n\t\t}\n\t}\n}\n\nfunction applyToTag (style, obj) {\n\tvar css = obj.css;\n\tvar media = obj.media;\n\n\tif(media) {\n\t\tstyle.setAttribute(\"media\", media)\n\t}\n\n\tif(style.styleSheet) {\n\t\tstyle.styleSheet.cssText = css;\n\t} else {\n\t\twhile(style.firstChild) {\n\t\t\tstyle.removeChild(style.firstChild);\n\t\t}\n\n\t\tstyle.appendChild(document.createTextNode(css));\n\t}\n}\n\nfunction updateLink (link, options, obj) {\n\tvar css = obj.css;\n\tvar sourceMap = obj.sourceMap;\n\n\t/*\n\t\tIf convertToAbsoluteUrls isn't defined, but sourcemaps are enabled\n\t\tand there is no publicPath defined then lets turn convertToAbsoluteUrls\n\t\ton by default.  Otherwise default to the convertToAbsoluteUrls option\n\t\tdirectly\n\t*/\n\tvar autoFixUrls = options.convertToAbsoluteUrls === undefined && sourceMap;\n\n\tif (options.convertToAbsoluteUrls || autoFixUrls) {\n\t\tcss = fixUrls(css);\n\t}\n\n\tif (sourceMap) {\n\t\t// http://stackoverflow.com/a/26603875\n\t\tcss += \"\\n/*# sourceMappingURL=data:application/json;base64,\" + btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))) + \" */\";\n\t}\n\n\tvar blob = new Blob([css], { type: \"text/css\" });\n\n\tvar oldSrc = link.href;\n\n\tlink.href = URL.createObjectURL(blob);\n\n\tif(oldSrc) URL.revokeObjectURL(oldSrc);\n}\n","\n/**\n * When source maps are enabled, `style-loader` uses a link element with a data-uri to\n * embed the css on the page. This breaks all relative urls because now they are relative to a\n * bundle instead of the current page.\n *\n * One solution is to only use full urls, but that may be impossible.\n *\n * Instead, this function \"fixes\" the relative urls to be absolute according to the current page location.\n *\n * A rudimentary test suite is located at `test/fixUrls.js` and can be run via the `npm test` command.\n *\n */\n\nmodule.exports = function (css) {\n  // get current location\n  var location = typeof window !== \"undefined\" && window.location;\n\n  if (!location) {\n    throw new Error(\"fixUrls requires window.location\");\n  }\n\n\t// blank or null?\n\tif (!css || typeof css !== \"string\") {\n\t  return css;\n  }\n\n  var baseUrl = location.protocol + \"//\" + location.host;\n  var currentDir = baseUrl + location.pathname.replace(/\\/[^\\/]*$/, \"/\");\n\n\t// convert each url(...)\n\t/*\n\tThis regular expression is just a way to recursively match brackets within\n\ta string.\n\n\t /url\\s*\\(  = Match on the word \"url\" with any whitespace after it and then a parens\n\t   (  = Start a capturing group\n\t     (?:  = Start a non-capturing group\n\t         [^)(]  = Match anything that isn't a parentheses\n\t         |  = OR\n\t         \\(  = Match a start parentheses\n\t             (?:  = Start another non-capturing groups\n\t                 [^)(]+  = Match anything that isn't a parentheses\n\t                 |  = OR\n\t                 \\(  = Match a start parentheses\n\t                     [^)(]*  = Match anything that isn't a parentheses\n\t                 \\)  = Match a end parentheses\n\t             )  = End Group\n              *\\) = Match anything and then a close parens\n          )  = Close non-capturing group\n          *  = Match anything\n       )  = Close capturing group\n\t \\)  = Match a close parens\n\n\t /gi  = Get all matches, not the first.  Be case insensitive.\n\t */\n\tvar fixedCss = css.replace(/url\\s*\\(((?:[^)(]|\\((?:[^)(]+|\\([^)(]*\\))*\\))*)\\)/gi, function(fullMatch, origUrl) {\n\t\t// strip quotes (if they exist)\n\t\tvar unquotedOrigUrl = origUrl\n\t\t\t.trim()\n\t\t\t.replace(/^\"(.*)\"$/, function(o, $1){ return $1; })\n\t\t\t.replace(/^'(.*)'$/, function(o, $1){ return $1; });\n\n\t\t// already a full url? no change\n\t\tif (/^(#|data:|http:\\/\\/|https:\\/\\/|file:\\/\\/\\/|\\s*$)/i.test(unquotedOrigUrl)) {\n\t\t  return fullMatch;\n\t\t}\n\n\t\t// convert the url to a full url\n\t\tvar newUrl;\n\n\t\tif (unquotedOrigUrl.indexOf(\"//\") === 0) {\n\t\t  \t//TODO: should we add protocol?\n\t\t\tnewUrl = unquotedOrigUrl;\n\t\t} else if (unquotedOrigUrl.indexOf(\"/\") === 0) {\n\t\t\t// path should be relative to the base url\n\t\t\tnewUrl = baseUrl + unquotedOrigUrl; // already starts with '/'\n\t\t} else {\n\t\t\t// path should be relative to current directory\n\t\t\tnewUrl = currentDir + unquotedOrigUrl.replace(/^\\.\\//, \"\"); // Strip leading './'\n\t\t}\n\n\t\t// send back the fixed url(...)\n\t\treturn \"url(\" + JSON.stringify(newUrl) + \")\";\n\t});\n\n\t// send back the fixed css\n\treturn fixedCss;\n};\n","///<reference path=\"../node_modules/grafana-sdk-mocks/app/headers/common.d.ts\" />\r\n\r\nimport coreModule from 'app/core/core_module';\r\n\r\n\r\nexport default class FindUSGSSiteModal {\r\n  /** @ngInject */\r\n  constructor(private $scope) {\r\n    \r\n    console.log( \"TODO... find USGS sites with\", this );\r\n  }\r\n\r\n  onSave() {\r\n    console.log( \"TODO... update the site ID\" );\r\n    this.dismiss();\r\n  }\r\n\r\n  dismiss() {\r\n    this.$scope.$parent.dismiss();\r\n  }\r\n}\r\n\r\nexport function findUSGSSiteModalDirective() {\r\n  return {\r\n    restrict: 'E',\r\n    templateUrl: 'public/plugins/natel-usgs-datasource/partials/find_site_modal.html',\r\n    controller: FindUSGSSiteModal,\r\n    bindToController: true,\r\n    transclude: true,\r\n    controllerAs: 'ctrl',\r\n    scope: {\r\n      target: '<', // The difference to '=' is that the bound properties are not watched\r\n      datasource: '<'\r\n    }\r\n  };\r\n}\r\n\r\ncoreModule.directive('findUsgsSiteModal', findUSGSSiteModalDirective);\r\n"],"sourceRoot":""}